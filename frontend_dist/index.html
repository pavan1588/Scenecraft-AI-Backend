<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>SceneCraftÂ AI</title>
  <style>
    /* Reset & base */
    * { box-sizing:border-box; margin:0; padding:0; }
    body { font-family:Arial,sans-serif; background:#0a0a0a; color:#eee; }
    #app { display:none; }

    /* Header/Nav */
    header {
      background:#11182a; padding:1rem 2rem;
      display:flex; justify-content:space-between; align-items:center;
      position:sticky; top:0; z-index:10;
    }
    .logo { font-size:1.5rem; color:#fdd835; }
    nav a {
      margin-left:1.5rem; padding:.5rem;
      color:#bbb; cursor:pointer; transition:color .2s;
    }
    nav a.active, nav a:hover { color:#fdd835; }
    nav a.disabled { color:#555; cursor:default; }

    /* Container */
    .container { max-width:900px; margin:2rem auto; padding:0 2rem; }

    /* Home */
    .hero { text-align:center; margin-bottom:2rem; }
    .hero h1 { font-size:3rem; color:#fdd835; margin-bottom:1rem; }
    .hero p { color:#ccc; font-size:1.1rem; }
    .features {
      display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      gap:1.5rem; margin-bottom:2rem;
    }
    .feature {
      background:#1a1a2e; border-radius:8px; padding:1.5rem; text-align:center;
    }
    .feature.coming-soon { opacity:.5; }

    /* Panels */
    section { display:none; }
    section.visible { display:block; }
    .panel {
      background:#1a1a2e; padding:2rem; border-radius:8px;
      margin:2rem auto; max-width:800px; position:relative;
      box-shadow:0 4px 10px rgba(0,0,0,0.5);
    }
    .panel h2 { color:#fdd835; margin-bottom:1rem; }
    .close-btn {
      position:absolute; top:1rem; right:1rem;
      background:transparent; border:none; color:#bbb;
      font-size:1.2rem; cursor:pointer;
    }
    textarea {
      width:100%; height:180px; background:#0f0f1f; color:#fff;
      border:none; padding:1rem; border-radius:5px;
      font-size:1rem; font-family:inherit;
    }
    .controls { margin-top:1rem; display:flex; align-items:center; gap:1rem; }
    .controls label { color:#ccc; font-size:.9rem; }
    button.action {
      margin-top:1.5rem; background:#fdd835; color:#111;
      border:none; padding:.75rem 1.5rem; border-radius:5px;
      font-weight:bold; cursor:pointer;
    }
    .output { margin-top:1.5rem; padding:1rem; background:#12121a; border-radius:5px; }
    .output p { margin-bottom:1rem; line-height:1.5; }
    footer { text-align:center; padding:2rem 0; color:#555; font-size:.9em; }
  </style>

  <script>
    // Password prompt every load
    (function(){
      const pw = prompt("ðŸ”’ Enter site password:");
      if (pw !== "SCENECRAFT-2024") {
        document.write('<div style="color:red;text-align:center;padding:3rem;"><h1>Access Denied</h1></div>');
        window.stop();
      } else {
        window.addEventListener('DOMContentLoaded', ()=> {
          document.getElementById('app').style.display = 'block';
        });
      }
    })();
  </script>
</head>

<body>
  <div id="app">
    <!-- NAV -->
    <header>
      <div class="logo">SceneCraftÂ AI</div>
      <nav>
        <a id="tabHome" class="active">Home</a>
        <a id="tabAnalyzer">Scene Analyzer</a>
        <a id="tabEditor">Scene Editor</a>
        <a class="disabled">Full Script Writer</a>
        <a class="disabled">How it Works</a>
        <a class="disabled">Pricing</a>
      </nav>
    </header>

    <div class="container">
      <!-- HOME -->
      <section id="home" class="visible">
        <div class="hero">
          <h1>SceneCraftÂ AI</h1>
          <p>Your cinematic storytelling partnerâ€”melding AI expertise with filmmaker craft to deliver instant, actionable feedback.</p>
        </div>
        <div class="features">
          <div class="feature"><h3>Scene Analyzer</h3><p>Deep insights on pacing, stakes, dialogue, and visual grammar.</p></div>
          <div class="feature"><h3>Scene Editor</h3><p>Lineâ€‘byâ€‘line rewrite suggestions with alternate phrasing.</p></div>
          <div class="feature coming-soon"><h3>Full Script Writer</h3><p>(ComingÂ Soon)</p></div>
          <div class="feature coming-soon"><h3>How it Works</h3><p>(ComingÂ Soon)</p></div>
          <div class="feature coming-soon"><h3>Pricing</h3><p>(ComingÂ Soon)</p></div>
        </div>
      </section>

      <!-- ANALYZER -->
      <section id="analyzer" class="panel">
        <button class="close-btn" id="closeAnalyzer">&times;</button>
        <h2>SceneÂ Analyzer</h2>
        <textarea id="sceneInput" placeholder="Paste your sceneâ€¦"></textarea>
        <div class="controls">
          <input type="file" id="sceneFile" accept=".txt,.pdf"/>
          <label><input type="checkbox" id="agreeChk"/> I agree to <a href="terms" style="color:#fdd835;">TermsÂ &Â Conditions</a></label>
        </div>
        <button id="analyzeBtn" class="action">Analyze Scene</button>
        <div id="output" class="output"></div>
      </section>

      <!-- EDITOR -->
      <section id="editor" class="panel">
        <button class="close-btn" id="closeEditor">&times;</button>
        <h2>SceneÂ Editor</h2>
        <textarea id="sceneInputEditor" placeholder="Paste your sceneâ€¦"></textarea>
        <div class="controls">
          <input type="file" id="sceneFileEditor" accept=".txt,.pdf"/>
          <label><input type="checkbox" id="agreeChkEditor"/> I agree to <a href="terms" style="color:#fdd835;">TermsÂ &Â Conditions</a></label>
        </div>
        <button id="editBtn" class="action">Get Rewrite Suggestions</button>
        <div id="editOutput" class="output"></div>
      </section>
    </div>

    <footer>&copy;Â 2025Â SceneCraftÂ AI</footer>
  </div>

  <script>
    // Reset helpers
    function resetAnalyzer(){
      document.getElementById('sceneInput').value = '';
      document.getElementById('sceneFile').value = '';
      document.getElementById('agreeChk').checked = false;
      document.getElementById('output').innerHTML = '';
      const btn = document.getElementById('analyzeBtn');
      btn.disabled = false; btn.textContent = 'Analyze Scene';
    }
    function resetEditor(){
      document.getElementById('sceneInputEditor').value = '';
      document.getElementById('sceneFileEditor').value = '';
      document.getElementById('agreeChkEditor').checked = false;
      document.getElementById('editOutput').innerHTML = '';
      const btn = document.getElementById('editBtn');
      btn.disabled = false; btn.textContent = 'Get Rewrite Suggestions';
    }

    // Tab switching
    const tabs = ['home','analyzer','editor'];
    function showTab(tab){
      tabs.forEach(id=>{
        document.getElementById(id).classList.toggle('visible', id===tab);
        document.getElementById('tab'+id.charAt(0).toUpperCase()+id.slice(1))
          .classList.toggle('active', id===tab);
      });
      if(tab==='analyzer') resetAnalyzer();
      if(tab==='editor')   resetEditor();
    }
    document.getElementById('tabHome').onclick     = ()=> showTab('home');
    document.getElementById('tabAnalyzer').onclick = ()=> showTab('analyzer');
    document.getElementById('tabEditor').onclick   = ()=> showTab('editor');
    document.getElementById('closeAnalyzer').onclick = ()=> showTab('home');
    document.getElementById('closeEditor').onclick   = ()=> showTab('home');

    // Single-run binder
    function bindSingleRun(textareaId, fileId, checkboxId, buttonId, runFunc) {
      const ta = document.getElementById(textareaId);
      const fi = document.getElementById(fileId);
      const cb = document.getElementById(checkboxId);
      const btn = document.getElementById(buttonId);

      btn.addEventListener('click', async () => {
        if (btn.disabled) return;
        await runFunc();
        btn.disabled = true;
        btn.textContent = 'Done';
      });

      function reenable(){
        btn.disabled = false;
        btn.textContent = (buttonId==='analyzeBtn') ? 'Analyze Scene' : 'Get Rewrite Suggestions';
      }

      ta.addEventListener('input', reenable);
      fi.addEventListener('change', reenable);
      cb.addEventListener('change', reenable);
    }

    // Analyzer run
    async function doAnalyzeScene(){
      const input = document.getElementById('sceneInput').value.trim();
      const file  = document.getElementById('sceneFile').files[0];
      const agree = document.getElementById('agreeChk').checked;
      if (!agree) return alert('Please accept the TermsÂ &Â Conditions.');
      let scene = input;
      if (!scene && file) scene = await file.text();
      if (!scene || scene.length<10) return alert('Enter at least 10 characters.');
      const out = document.getElementById('output');
      out.innerHTML = '<p style="color:#fdd835;">Analyzingâ€¦</p>';
      try {
        const res = await fetch('/analyze', {
          method:'POST',
          headers:{'Content-Type':'application/json','x-user-agreement':'true'},
          body: JSON.stringify({ scene })
        });
        if (!res.ok) throw new Error(`HTTPÂ ${res.status}`);
        const data = await res.json();
        out.innerHTML = data.analysis.split('\n\n').map(p=>`<p>${p}</p>`).join('');
      } catch(e) {
        out.innerHTML = `<p style="color:red;">Error: ${e.message}</p>`;
      }
    }

    // Editor run
    async function doEditScene(){
      const input = document.getElementById('sceneInputEditor').value.trim();
      const file  = document.getElementById('sceneFileEditor').files[0];
      const agree = document.getElementById('agreeChkEditor').checked;
      if (!agree) return alert('Please accept the TermsÂ &Â Conditions.');
      let scene = input;
      if (!scene && file) scene = await file.text();
      if (!scene || scene.length<10) return alert('Enter at least 10 characters.');
      const out = document.getElementById('editOutput');
      out.innerHTML = '<p style="color:#fdd835;">Generating rewritesâ€¦</p>';
      try {
        const res = await fetch('/editor/analyze', {
          method:'POST',
          headers:{'Content-Type':'application/json','x-user-agreement':'true'},
          body: JSON.stringify({ scene })
        });
        if (!res.ok) throw new Error(`HTTPÂ ${res.status}`);
        const data = await res.json();
        const content = data.rewrites?.trim() || 'No suggestions.';
        out.innerHTML = content.split('\n\n').map(p=>`<p>${p}</p>`).join('');
      } catch(e) {
        out.innerHTML = `<p style="color:red;">Error: ${e.message}</p>`;
      }
    }

    // Bind buttons
    bindSingleRun('sceneInput','sceneFile','agreeChk','analyzeBtn', doAnalyzeScene);
    bindSingleRun('sceneInputEditor','sceneFileEditor','agreeChkEditor','editBtn', doEditScene);
  </script>
</body>
</html>
